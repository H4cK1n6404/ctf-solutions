_p = 122488473105892538559311426995019720049507640328167439356838797108079051563759027212419257414247
g = 2
_h = 41265478705979402454324352217321371405801956976004231887598587967923553448391717998290661984177

p_factors = [6971096459, 261841354058939, 9293011496905768559, 336286207038529046808347, 21472883178031195225853317139]

def dlog(p):
	g = 2
	h = _h % p
	R = IntegerModRing(p)
	x = discrete_log(R(h), R(g))
	return x

X = []
MOD = []

for p in p_factors:
    x = dlog(p)
    assert pow(g, x, p) == _h%p
    X.append(x)
    MOD.append(p-1)

x = crt(X, MOD)
assert pow(g, x, _p) == _h
print(x)
